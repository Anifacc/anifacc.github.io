<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="categories" content="">
<meta name="layout" content="post"><style>body {
  max-width: 980px;
  border: 1px solid #ddd;
  outline: 1300px solid #fff;
  margin: 16px auto;
}

body .markdown-body
{
  padding: 45px;
}

@font-face {
  font-family: fontawesome-mini;
  src: url(data:font/woff;charset=utf-8;base64,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) format('woff');
}

@font-face {
  font-family: octicons-anchor;
  src: url(data:font/woff;charset=utf-8;base64,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) format('woff');
}

.markdown-body {
  font-family: sans-serif;
  -ms-text-size-adjust: 100%;
  -webkit-text-size-adjust: 100%;
  color: #333333;
  overflow: hidden;
  font-family: "Helvetica Neue", Helvetica, "Segoe UI", Arial, freesans, sans-serif;
  font-size: 16px;
  line-height: 1.6;
  word-wrap: break-word;
}

.markdown-body a {
  background: transparent;
}

.markdown-body a:active,
.markdown-body a:hover {
  outline: 0;
}

.markdown-body b,
.markdown-body strong {
  font-weight: bold;
}

.markdown-body mark {
  background: #ff0;
  color: #000;
  font-style: italic;
  font-weight: bold;
}

.markdown-body sub,
.markdown-body sup {
  font-size: 75%;
  line-height: 0;
  position: relative;
  vertical-align: baseline;
}
.markdown-body sup {
  top: -0.5em;
}
.markdown-body sub {
  bottom: -0.25em;
}

.markdown-body h1 {
  font-size: 2em;
  margin: 0.67em 0;
}

.markdown-body img {
  border: 0;
}

.markdown-body hr {
  -moz-box-sizing: content-box;
  box-sizing: content-box;
  height: 0;
}

.markdown-body pre {
  overflow: auto;
}

.markdown-body code,
.markdown-body kbd,
.markdown-body pre,
.markdown-body samp {
  font-family: monospace, monospace;
  font-size: 1em;
}

.markdown-body input {
  color: inherit;
  font: inherit;
  margin: 0;
}

.markdown-body html input[disabled] {
  cursor: default;
}

.markdown-body input {
  line-height: normal;
}

.markdown-body input[type="checkbox"] {
  box-sizing: border-box;
  padding: 0;
}

.markdown-body table {
  border-collapse: collapse;
  border-spacing: 0;
}

.markdown-body td,
.markdown-body th {
  padding: 0;
}

.markdown-body .codehilitetable {
  border: 0;
  border-spacing: 0;
}

.markdown-body .codehilitetable tr {
  border: 0;
}

.markdown-body .codehilitetable pre,
.markdown-body .codehilitetable div.codehilite {
  margin: 0;
}

.markdown-body .linenos,
.markdown-body .code,
.markdown-body .codehilitetable td {
  border: 0;
  padding: 0;
}

.markdown-body td:not(.linenos) .linenodiv {
  padding: 0 !important;
}

.markdown-body .code {
  width: 100%;
}

.markdown-body .linenos div pre,
.markdown-body .linenodiv pre,
.markdown-body .linenodiv {
  border: 0;
  -webkit-border-radius: 0;
  -moz-border-radius: 0;
  border-radius: 0;
  -webkit-border-top-left-radius: 3px;
  -webkit-border-bottom-left-radius: 3px;
  -moz-border-radius-topleft: 3px;
  -moz-border-radius-bottomleft: 3px;
  border-top-left-radius: 3px;
  border-bottom-left-radius: 3px;
}

.markdown-body .code div pre,
.markdown-body .code div {
  border: 0;
  -webkit-border-radius: 0;
  -moz-border-radius: 0;
  border-radius: 0;
  -webkit-border-top-right-radius: 3px;
  -webkit-border-bottom-right-radius: 3px;
  -moz-border-radius-topright: 3px;
  -moz-border-radius-bottomright: 3px;
  border-top-right-radius: 3px;
  border-bottom-right-radius: 3px;
}

.markdown-body * {
  -moz-box-sizing: border-box;
  box-sizing: border-box;
}

.markdown-body input {
  font: 13px Helvetica, arial, freesans, clean, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol";
  line-height: 1.4;
}

.markdown-body a {
  color: #4183c4;
  text-decoration: none;
}

.markdown-body a:hover,
.markdown-body a:focus,
.markdown-body a:active {
  text-decoration: underline;
}

.markdown-body hr {
  height: 0;
  margin: 15px 0;
  overflow: hidden;
  background: transparent;
  border: 0;
  border-bottom: 1px solid #ddd;
}

.markdown-body hr:before,
.markdown-body hr:after {
  display: table;
  content: " ";
}

.markdown-body hr:after {
  clear: both;
}

.markdown-body h1,
.markdown-body h2,
.markdown-body h3,
.markdown-body h4,
.markdown-body h5,
.markdown-body h6 {
  margin-top: 15px;
  margin-bottom: 15px;
  line-height: 1.1;
}

.markdown-body h1 {
  font-size: 30px;
}

.markdown-body h2 {
  font-size: 21px;
}

.markdown-body h3 {
  font-size: 16px;
}

.markdown-body h4 {
  font-size: 14px;
}

.markdown-body h5 {
  font-size: 12px;
}

.markdown-body h6 {
  font-size: 11px;
}

.markdown-body blockquote {
  margin: 0;
}

.markdown-body ul,
.markdown-body ol {
  padding: 0;
  margin-top: 0;
  margin-bottom: 0;
}

.markdown-body ol ol,
.markdown-body ul ol {
  list-style-type: lower-roman;
}

.markdown-body ul ul ol,
.markdown-body ul ol ol,
.markdown-body ol ul ol,
.markdown-body ol ol ol {
  list-style-type: lower-alpha;
}

.markdown-body dd {
  margin-left: 0;
}

.markdown-body code,
.markdown-body pre,
.markdown-body samp {
  font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
  font-size: 12px;
}

.markdown-body pre {
  margin-top: 0;
  margin-bottom: 0;
}

.markdown-body kbd {
  background-color: #e7e7e7;
  background-image: -moz-linear-gradient(#fefefe, #e7e7e7);
  background-image: -webkit-linear-gradient(#fefefe, #e7e7e7);
  background-image: linear-gradient(#fefefe, #e7e7e7);
  background-repeat: repeat-x;
  border-radius: 2px;
  border: 1px solid #cfcfcf;
  color: #000;
  padding: 3px 5px;
  line-height: 10px;
  font: 11px Consolas, "Liberation Mono", Menlo, Courier, monospace;
  display: inline-block;
}

.markdown-body>*:first-child {
  margin-top: 0 !important;
}

.markdown-body>*:last-child {
  margin-bottom: 0 !important;
}

.markdown-body .headeranchor-link {
  position: absolute;
  top: 0;
  bottom: 0;
  left: 0;
  display: block;
  padding-right: 6px;
  padding-left: 30px;
  margin-left: -30px;
}

.markdown-body .headeranchor-link:focus {
  outline: none;
}

.markdown-body h1,
.markdown-body h2,
.markdown-body h3,
.markdown-body h4,
.markdown-body h5,
.markdown-body h6 {
  position: relative;
  margin-top: 1em;
  margin-bottom: 16px;
  font-weight: bold;
  line-height: 1.4;
}

.markdown-body h1 .headeranchor,
.markdown-body h2 .headeranchor,
.markdown-body h3 .headeranchor,
.markdown-body h4 .headeranchor,
.markdown-body h5 .headeranchor,
.markdown-body h6 .headeranchor {
  display: none;
  color: #000;
  vertical-align: middle;
}

.markdown-body h1:hover .headeranchor-link,
.markdown-body h2:hover .headeranchor-link,
.markdown-body h3:hover .headeranchor-link,
.markdown-body h4:hover .headeranchor-link,
.markdown-body h5:hover .headeranchor-link,
.markdown-body h6:hover .headeranchor-link {
  height: 1em;
  padding-left: 8px;
  margin-left: -30px;
  line-height: 1;
  text-decoration: none;
}

.markdown-body h1:hover .headeranchor-link .headeranchor,
.markdown-body h2:hover .headeranchor-link .headeranchor,
.markdown-body h3:hover .headeranchor-link .headeranchor,
.markdown-body h4:hover .headeranchor-link .headeranchor,
.markdown-body h5:hover .headeranchor-link .headeranchor,
.markdown-body h6:hover .headeranchor-link .headeranchor {
  display: inline-block;
}

.markdown-body h1 {
  padding-bottom: 0.3em;
  font-size: 2.25em;
  line-height: 1.2;
  border-bottom: 1px solid #eee;
}

.markdown-body h2 {
  padding-bottom: 0.3em;
  font-size: 1.75em;
  line-height: 1.225;
  border-bottom: 1px solid #eee;
}

.markdown-body h3 {
  font-size: 1.5em;
  line-height: 1.43;
}

.markdown-body h4 {
  font-size: 1.25em;
}

.markdown-body h5 {
  font-size: 1em;
}

.markdown-body h6 {
  font-size: 1em;
  color: #777;
}

.markdown-body p,
.markdown-body blockquote,
.markdown-body ul,
.markdown-body ol,
.markdown-body dl,
.markdown-body table,
.markdown-body pre,
.markdown-body .admonition {
  margin-top: 0;
  margin-bottom: 16px;
}

.markdown-body hr {
  height: 4px;
  padding: 0;
  margin: 16px 0;
  background-color: #e7e7e7;
  border: 0 none;
}

.markdown-body ul,
.markdown-body ol {
  padding-left: 2em;
}

.markdown-body ul ul,
.markdown-body ul ol,
.markdown-body ol ol,
.markdown-body ol ul {
  margin-top: 0;
  margin-bottom: 0;
}

.markdown-body li>p {
  margin-top: 16px;
}

.markdown-body dl {
  padding: 0;
}

.markdown-body dl dt {
  padding: 0;
  margin-top: 16px;
  font-size: 1em;
  font-style: italic;
  font-weight: bold;
}

.markdown-body dl dd {
  padding: 0 16px;
  margin-bottom: 16px;
}

.markdown-body blockquote {
  padding: 0 15px;
  color: #777;
  border-left: 4px solid #ddd;
}

.markdown-body blockquote>:first-child {
  margin-top: 0;
}

.markdown-body blockquote>:last-child {
  margin-bottom: 0;
}

.markdown-body table {
  display: block;
  width: 100%;
  overflow: auto;
  word-break: normal;
  word-break: keep-all;
}

.markdown-body table th {
  font-weight: bold;
}

.markdown-body table th,
.markdown-body table td {
  padding: 6px 13px;
  border: 1px solid #ddd;
}

.markdown-body table tr {
  background-color: #fff;
  border-top: 1px solid #ccc;
}

.markdown-body table tr:nth-child(2n) {
  background-color: #f8f8f8;
}

.markdown-body img {
  max-width: 100%;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
}

.markdown-body code,
.markdown-body samp {
  padding: 0;
  padding-top: 0.2em;
  padding-bottom: 0.2em;
  margin: 0;
  font-size: 85%;
  background-color: rgba(0,0,0,0.04);
  border-radius: 3px;
}

.markdown-body code:before,
.markdown-body code:after {
  letter-spacing: -0.2em;
  content: "\00a0";
}

.markdown-body pre>code {
  padding: 0;
  margin: 0;
  font-size: 100%;
  word-break: normal;
  white-space: pre;
  background: transparent;
  border: 0;
}

.markdown-body .codehilite {
  margin-bottom: 16px;
}

.markdown-body .codehilite pre,
.markdown-body pre {
  padding: 16px;
  overflow: auto;
  font-size: 85%;
  line-height: 1.45;
  background-color: #f7f7f7;
  border-radius: 3px;
}

.markdown-body .codehilite pre {
  margin-bottom: 0;
  word-break: normal;
}

.markdown-body pre {
  word-wrap: normal;
}

.markdown-body pre code {
  display: inline;
  max-width: initial;
  padding: 0;
  margin: 0;
  overflow: initial;
  line-height: inherit;
  word-wrap: normal;
  background-color: transparent;
  border: 0;
}

.markdown-body pre code:before,
.markdown-body pre code:after {
  content: normal;
}

/* Admonition */
.markdown-body .admonition {
  -webkit-border-radius: 3px;
  -moz-border-radius: 3px;
  position: relative;
  border-radius: 3px;
  border: 1px solid #e0e0e0;
  border-left: 6px solid #333;
  padding: 10px 10px 10px 30px;
}

.markdown-body .admonition table {
  color: #333;
}

.markdown-body .admonition p {
  padding: 0;
}

.markdown-body .admonition-title {
  font-weight: bold;
  margin: 0;
}

.markdown-body .admonition>.admonition-title {
  color: #333;
}

.markdown-body .attention>.admonition-title {
  color: #a6d796;
}

.markdown-body .caution>.admonition-title {
  color: #d7a796;
}

.markdown-body .hint>.admonition-title {
  color: #96c6d7;
}

.markdown-body .danger>.admonition-title {
  color: #c25f77;
}

.markdown-body .question>.admonition-title {
  color: #96a6d7;
}

.markdown-body .note>.admonition-title {
  color: #d7c896;
}

.markdown-body .admonition:before,
.markdown-body .attention:before,
.markdown-body .caution:before,
.markdown-body .hint:before,
.markdown-body .danger:before,
.markdown-body .question:before,
.markdown-body .note:before {
  font: normal normal 16px fontawesome-mini;
  -moz-osx-font-smoothing: grayscale;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  line-height: 1.5;
  color: #333;
  position: absolute;
  left: 0;
  top: 0;
  padding-top: 10px;
  padding-left: 10px;
}

.markdown-body .admonition:before {
  content: "\f056\00a0";
  color: 333;
}

.markdown-body .attention:before {
  content: "\f058\00a0";
  color: #a6d796;
}

.markdown-body .caution:before {
  content: "\f06a\00a0";
  color: #d7a796;
}

.markdown-body .hint:before {
  content: "\f05a\00a0";
  color: #96c6d7;
}

.markdown-body .danger:before {
  content: "\f057\00a0";
  color: #c25f77;
}

.markdown-body .question:before {
  content: "\f059\00a0";
  color: #96a6d7;
}

.markdown-body .note:before {
  content: "\f040\00a0";
  color: #d7c896;
}

.markdown-body .admonition::after {
  content: normal;
}

.markdown-body .attention {
  border-left: 6px solid #a6d796;
}

.markdown-body .caution {
  border-left: 6px solid #d7a796;
}

.markdown-body .hint {
  border-left: 6px solid #96c6d7;
}

.markdown-body .danger {
  border-left: 6px solid #c25f77;
}

.markdown-body .question {
  border-left: 6px solid #96a6d7;
}

.markdown-body .note {
  border-left: 6px solid #d7c896;
}

.markdown-body .admonition>*:first-child {
  margin-top: 0 !important;
}

.markdown-body .admonition>*:last-child {
  margin-bottom: 0 !important;
}

/* progress bar*/
.markdown-body .progress {
  display: block;
  width: 300px;
  margin: 10px 0;
  height: 24px;
  -webkit-border-radius: 3px;
  -moz-border-radius: 3px;
  border-radius: 3px;
  background-color: #ededed;
  position: relative;
  box-shadow: inset -1px 1px 3px rgba(0, 0, 0, .1);
}

.markdown-body .progress-label {
  position: absolute;
  text-align: center;
  font-weight: bold;
  width: 100%; margin: 0;
  line-height: 24px;
  color: #333;
  text-shadow: 1px 1px 0 #fefefe, -1px -1px 0 #fefefe, -1px 1px 0 #fefefe, 1px -1px 0 #fefefe, 0 1px 0 #fefefe, 0 -1px 0 #fefefe, 1px 0 0 #fefefe, -1px 0 0 #fefefe, 1px 1px 2px #000;
  -webkit-font-smoothing: antialiased !important;
  white-space: nowrap;
  overflow: hidden;
}

.markdown-body .progress-bar {
  height: 24px;
  float: left;
  -webkit-border-radius: 3px;
  -moz-border-radius: 3px;
  border-radius: 3px;
  background-color: #96c6d7;
  box-shadow: inset 0 1px 0 rgba(255, 255, 255, .5), inset 0 -1px 0 rgba(0, 0, 0, .1);
  background-size: 30px 30px;
  background-image: -webkit-linear-gradient(
    135deg, rgba(255, 255, 255, .4) 27%,
    transparent 27%,
    transparent 52%, rgba(255, 255, 255, .4) 52%,
    rgba(255, 255, 255, .4) 77%,
    transparent 77%, transparent
  );
  background-image: -moz-linear-gradient(
    135deg,
    rgba(255, 255, 255, .4) 27%, transparent 27%,
    transparent 52%, rgba(255, 255, 255, .4) 52%,
    rgba(255, 255, 255, .4) 77%, transparent 77%,
    transparent
  );
  background-image: -ms-linear-gradient(
    135deg,
    rgba(255, 255, 255, .4) 27%, transparent 27%,
    transparent 52%, rgba(255, 255, 255, .4) 52%,
    rgba(255, 255, 255, .4) 77%, transparent 77%,
    transparent
  );
  background-image: -o-linear-gradient(
    135deg,
    rgba(255, 255, 255, .4) 27%, transparent 27%,
    transparent 52%, rgba(255, 255, 255, .4) 52%,
    rgba(255, 255, 255, .4) 77%, transparent 77%,
    transparent
  );
  background-image: linear-gradient(
    135deg,
    rgba(255, 255, 255, .4) 27%, transparent 27%,
    transparent 52%, rgba(255, 255, 255, .4) 52%,
    rgba(255, 255, 255, .4) 77%, transparent 77%,
    transparent
  );
}

.markdown-body .progress-100plus .progress-bar {
  background-color: #a6d796;
}

.markdown-body .progress-80plus .progress-bar {
  background-color: #c6d796;
}

.markdown-body .progress-60plus .progress-bar {
  background-color: #d7c896;
}

.markdown-body .progress-40plus .progress-bar {
  background-color: #d7a796;
}

.markdown-body .progress-20plus .progress-bar {
  background-color: #d796a6;
}

.markdown-body .progress-0plus .progress-bar {
  background-color: #c25f77;
}

.markdown-body .candystripe-animate .progress-bar{
  -webkit-animation: animate-stripes 3s linear infinite;
  -moz-animation: animate-stripes 3s linear infinite;
  animation: animate-stripes 3s linear infinite;
}

@-webkit-keyframes animate-stripes {
  0% {
    background-position: 0 0;
  }

  100% {
    background-position: 60px 0;
  }
}

@-moz-keyframes animate-stripes {
  0% {
    background-position: 0 0;
  }

  100% {
    background-position: 60px 0;
  }
}

@keyframes animate-stripes {
  0% {
    background-position: 0 0;
  }

  100% {
    background-position: 60px 0;
  }
}

.markdown-body .gloss .progress-bar {
  box-shadow:
    inset 0 4px 12px rgba(255, 255, 255, .7),
    inset 0 -12px 0 rgba(0, 0, 0, .05);
}

/* Multimarkdown Critic Blocks */
.markdown-body .critic_mark {
  background: #ff0;
}

.markdown-body .critic_delete {
  color: #c82829;
  text-decoration: line-through;
}

.markdown-body .critic_insert {
  color: #718c00 ;
  text-decoration: underline;
}

.markdown-body .critic_comment {
  color: #8e908c;
  font-style: italic;
}

.markdown-body .headeranchor {
  font: normal normal 16px octicons-anchor;
  line-height: 1;
  display: inline-block;
  text-decoration: none;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.headeranchor:before {
  content: '\f05c';
}

.markdown-body .task-list-item {
  list-style-type: none;
}

.markdown-body .task-list-item+.task-list-item {
  margin-top: 3px;
}

.markdown-body .task-list-item input {
  margin: 0 4px 0.25em -20px;
  vertical-align: middle;
}

/* Media */
@media only screen and (min-width: 480px) {
  .markdown-body {
    font-size:14px;
  }
}

@media only screen and (min-width: 768px) {
  .markdown-body {
    font-size:16px;
  }
}

@media print {
  .markdown-body * {
    background: transparent !important;
    color: black !important;
    filter:none !important;
    -ms-filter: none !important;
  }

  .markdown-body {
    font-size:12pt;
    max-width:100%;
    outline:none;
    border: 0;
  }

  .markdown-body a,
  .markdown-body a:visited {
    text-decoration: underline;
  }

  .markdown-body .headeranchor-link {
    display: none;
  }

  .markdown-body a[href]:after {
    content: " (" attr(href) ")";
  }

  .markdown-body abbr[title]:after {
    content: " (" attr(title) ")";
  }

  .markdown-body .ir a:after,
  .markdown-body a[href^="javascript:"]:after,
  .markdown-body a[href^="#"]:after {
    content: "";
  }

  .markdown-body pre {
    white-space: pre;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  .markdown-body pre,
  .markdown-body blockquote {
    border: 1px solid #999;
    padding-right: 1em;
    page-break-inside: avoid;
  }

  .markdown-body .progress,
  .markdown-body .progress-bar {
    -moz-box-shadow: none;
    -webkit-box-shadow: none;
    box-shadow: none;
  }

  .markdown-body .progress {
    border: 1px solid #ddd;
  }

  .markdown-body .progress-bar {
    height: 22px;
    border-right: 1px solid #ddd;
  }

  .markdown-body tr,
  .markdown-body img {
    page-break-inside: avoid;
  }

  .markdown-body img {
    max-width: 100% !important;
  }

  .markdown-body p,
  .markdown-body h2,
  .markdown-body h3 {
    orphans: 3;
    widows: 3;
  }

  .markdown-body h2,
  .markdown-body h3 {
    page-break-after: avoid;
  }
}
</style><title>LFD第四章笔记:Validation</title></head><body><article class="markdown-body"><ul>
<li>MachineLearning</li>
<li>LearningFromData</li>
</ul>
<hr />
<p>书本[1]4.3节讲述另一种&rdquo;治疗&rdquo; overfitting 的方法: Validation. 书本先讲述</p>
<ul>
<li>(1) Validation Set: 什么是 validation set?</li>
<li>(2) Model Selection: validation 可以用于 model selection.</li>
<li>(3) Cross Validation: 交叉验证. validation 方法: Leave-One-Out, V-Fold(K-Fold)</li>
</ul>
<p>书本还是偏重理论讲解, 我们得加强实战内容. 还好马上就要把这本书前半部分基础理论啃完, 之后就要进入实战. 在以后具体算法部分, 以 Top-Down 方式来学习. Validation 这部分理论内容帮助我们理解 Scikit-Learn 机器学习库中的 validation 的具体应用, 理解它的原理, 真是舒畅.</p>
<h2 id="0intro"><a name="user-content-0intro" href="#0intro" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>0.Intro</h2>
<p>我们可以认为: regularization 和本节中讲述的 validation 都在最小化 $$E_{out}$$ 上面作文章, 而不是 $$E_{in}$$. 然后, 显示中, 我们只有 sample, 我们不可能知道真实的 $$E_{out}$$, 所以我们只能基于现有的样本去估计 $$E_{out}$$. 从某种角度来讲, <em>find an in-sample estimate of the out-of-sample error</em> 是机器学习的必杀技(Holy Grail of machine learning.). 这逻辑很正确, 我们只能根据已有的(采集到的)数据样本(sample) 来估计 out-of-sample error.</p>
<p>Regularization 最小化 out-of-sample error 的方法是通过 overfit penalty.</p>
<p>$$E_{out}(h) = E_{in}(h) + \text{overfit penalty}$$<br />
$$E_{out}(h) = E_{in}(h) + \frac{\lambda}{N} \Omega(h)$$</p>
<p>而在 Validation 中, 直接估算 out-of-sample error.</p>
<p>$$E_{out}(h) = E_{in}(h) + \text{overfit penalty}$$</p>
<p>在第二章中, 我们有了解 test set. 将数据分为训练集 和 测试集. 测试集就是用来评估学习算法得到最终假设的性能($$E_{test}$$ 是否很小或满足要求.)</p>
<blockquote>
<p>Test error $$E_{test}$$, unlike the in-sample-error $$E_{in}$$, is an unbiased estimate of $$E_{out}$$.</p>
</blockquote>
<p>test error $$E_{test}$$ 是 out-of-sample error $$E_{out}$$ 的无偏估计 (很多很多个 test error 变量的期望等于 out-of-sample error).</p>
<p><img alt="01-test-set" src="https://dn-learnml.qbox.me/image/ai/lfd_ch04_01_test_set.JPG" /></p>
<p>下面我们来看看到底什么是 Validation?</p>
<hr />
<h2 id="1validation-set"><a name="user-content-1validation-set" href="#1validation-set" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>1.Validation Set</h2>
<p>在理解什么是 Validation 之前, 我们先来理解什么是 validation set.</p>
<p><strong>Validation Set</strong> 就是在 Validation 中所使用的数据集, 称为验证集(validation set).</p>
<p>我们首先从数据集中取出一个子集, 这个子集中的样本不用于训练. 比如, 我们的总样本集为 $$\cal D$$, 样本个数为 N . 我们将其划分为包含 (N-K) 个样本的训练集 $$\cal D_{train}$$, 以及包含 K 个样本的验证集 $$\cal D_{val}$$, 它们分别用于模型训练和模型验证. 这时候, 未用于训练的 K 个样本, 我们将其作为 out-of-sample 来看待, 用来估计 $$E_{out}$$.</p>
<p>验证集 和 测试集 的区别. 虽然两者都没有用于模型训练, 但是验证集影响着模型学习过程, 它影响最终假设的确定. 而测试集并没有这样的影响, 测试集只在最终假设确定后, 用来评断模型学习能力.</p>
<p>那么我们可不可以从数据集角度来理解, 总数据集 $$\cal D_{all}$$. 我们要将其分为 $$\cal D_{1}, D_{test}$$.</p>
<ul>
<li>$$\cal D_{1}$$: 用于模型训练, 并确定最终假设. 这又分为:</li>
<li>$$\cal D_{train}$$: 用于模型训练的训练集</li>
<li>$$\cal D_{val}$$: 用于模型验证的验证集, 该数据集并不用于模型训练</li>
<li>$$\cal D_{test}$$: 用于测试最终假设效果的测试集.</li>
</ul>
<p>我们可不可以这样理解: 在模型选择, 训练, 确定最终假设过程中, 我们需要使用的是 训练集和验证集. 之后测试模型最终效果时, 我们需要使用测试集? 这样理解, 就不会将测试集和验证集混淆呢? 待定, 自己思考.</p>
<p><img alt="02-validation-set" src="https://dn-learnml.qbox.me/image/ai/lfd_ch04_02_validation_set.JPG" /></p>
<p>现在, 我们的总样本集为 $$\cal D$$, 样本个数为 N . 我们将其划分为包含 (N-K) 个样本的训练集 $$\cal D_{train}$$, 以及包含 K 个样本的验证集 $$\cal D_{val}$$, 它们分别用于模型训练和模型验证.</p>
<p>我们通过训练集 $$\cal D_{train}$$ 训练模型得到一个最终假设 $$g^{-} \in {\cal H}$$, 然后我们用这个假设在验证集(validation set) 上计算 validation error(验证误差)</p>
<p>$$E_{val}(g^{-}) = \frac{1}{K} \sum_{ {\bf x}<em val="val">n \in {\cal D</em>} }  {\bf e} \left( g^{-}({\bf x}_n, y_n)\right)$$</p>
<p>其中 $${\bf e} \left( g^{-}({\bf x}_n, y_n)\right)$$ 为验证集中每个样本的误差. 对于分类问题: $${\bf e} \left( g^{-}({\bf x}_n, y_n)\right) = [[g^{-}({\bf x}) \neq y]]$$, 即 如果 $$g^{-}({\bf x}) \neq y$$, 则误差为1, 否则为0. 对于回归问题, 使用平方误差, 如 $${\bf e} \left( g^{-}({\bf x}_n, y_n)\right) = \left( g^{-}({\bf x}) - y \right)^2$$.</p>
<p>Validation error $$E_{val}$$ 也是 out-of-sample error $$E_{out}$$ 的无偏估计(因为最终假设 $$g^{-} $$ 的确定不依赖于 验证集中的样本, 只依赖与训练集中的样本). 因此有:</p>
<p>$$\begin{align} \Bbb E_{{\cal D_{val}}} \left[ E_{val} (g^{-}) ] &amp;= \frac{1}{K} \sum_{ {\bf x}<em val="val">n \in {\cal D</em>} } \Bbb E_{\cal D_{val}} \left[ {\bf e} \left( g^{-}({\bf x}<em _bf="{\bf" x="x">n, y_n)\right) \right] \<br />
    &amp;= \frac{1}{K} \sum</em><em val="val">n \in {\cal D</em>} } \Bbb E_{ {\bf x}<em _bf="{\bf" x="x">n } \left[ {\bf e} \left( g^{-}({\bf x}_n, y_n)\right) \right]\<br />
    &amp;= \frac{1}{K} \sum</em><em val="val">n \in {\cal D</em>} } E_{out}(g^{-}) \<br />
    &amp;= E_{out}(g^{-}) \tag{4.8} \end{align}$$</p>
<p>第二个等式变化中, e 只与 $$D_{val}$$ 中的 $${\bf x}_n 有关$$. [其无偏估计与 test set 中计算类似.]</p>
<p>$$E_{val}$$ 估计 $$E_{out}$$ 的可靠性如何? 书中以 分类问题为例. 利用 Hoeffding 不等式 和 VC 边界.</p>
<p>$$E_{out}(g^-) \leq E_{val}(g^-) + O\left(\frac{1}{\sqrt{K}} \right) \tag{4.9}$$</p>
<p>将 $$\cal D_{val}$$ 当作 &ldquo;in-sample&rdquo; data set. 不限现在的假设集中只有一个假设$$g^-$$, 样本数目为 K.</p>
<p>同样, 按照 Test set 中推演, 我们可以得到:</p>
<p>$$\begin{align}<br />
{\bf Var} [E_{val}(g^{-})] &amp;= \frac{1}{K^2} \sum_{k=1}^K {\bf Var}[e_k] \<br />
  &amp;= \frac{1}{K} {\bf Var}<em val="val">{\bf x}[e(g^{-}({\bf x}), y)]  \<br />
  &amp;= \sigma</em>^2<br />
\end{align}$$</p>
<p>书中以2次多项式 $$\cal H_2$$的期望验证误差, 其图形如下所示. 其中: target function 的为 10次多项式 $$Q_f = 10$$, 数据集样本总数为 $$N =40$$, 噪声水平 $$\sigma^2 = 0.4$$. 验证误差的期望等于 $$E_{out}(g^-)$$, 如公式(4.8)所示.</p>
<p><img alt="03-expected-val-error" src="https://dn-learnml.qbox.me/image/ai/lfd_ch04_03_expected_validation_error.JPG" /></p>
<p>注: 蓝色线为 $$\Bbb E[E_{val}(g^-)]$$, 是关于 K 的函数, 而阴影部分区域为: $$\Bbb E[E_{val}(g^-)] \pm \sigma_{val}$$.</p>
<p>从上图中, 我们可以看出, 验证集样本数目 K变化时, 验证误差的期望也变化. 大体趋势是: K 增大, $$\Bbb E[E_{val}]$$ 先减小, 后增大. 所以 K 的选择需要慎重. <strong>实际经验公式: K = N/5</strong>. (数据集N中的20%可用作验证集).</p>
<p>关于验证集数目 K, 我们还需要讨论一下[1].</p>
<ul>
<li>(1) It has to be big enough for $$E_{val}$$  to be reliable, and(公式 4.9)</li>
<li>(2) it has to be small enough so that the training set with N-K points is big enough to get a decent $$g^-$$.(从之前的学习曲线 learning curve可以看出.) [The fact that more training data lead to a better final hypothesis has been extensively verified empirically, although it is challenging to prove theoretically.]</li>
</ul>
<p>这里就出现矛盾了吧. 经验是训练集数目越大, 我们最终假设也越好. 但用理论很难证明.</p>
<h3 id="11-restoring-d"><a name="user-content-11-restoring-d" href="#11-restoring-d" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>1.1 Restoring D</h3>
<p><img alt="04_validation_set_estimate" src="https://dn-learnml.qbox.me/image/ai/lfd_ch04_04_val_estimate_e_out.JPG" /></p>
<p>我们有数据集 D, 主要目标是在所有N个数据上进行训练, 得到最终假设 $$g$$, 通过 $$E_{in}(g)$$ 来估计 $$E_{out}(g)$$; 现在, 使用 validation, 我们的目标变为 估计 $$E_{out}(g)$$, 但是 我们只能在 N-K 个数据上训练得到最终假设 $$g^-$$, 并通过验证集得到 $$E_{val}(g^-)$$, 并用其来估计 $$E_{out}(g^-)$$.</p>
<p>(1) 主要目标:</p>
<p>$$E_{out}(g) \leq E_{in}(g) + O \left( \sqrt{\frac{d_{vc}}{N} \log N} \right) \tag{4.10.1}$$</p>
<p>不等式中的 最后的小量 is biased error bar depends on $$\cal H$$</p>
<p>(2) 次要目标:</p>
<p>$$E_{out}(g) \leq E_{out}(g^-) \leq E_{val}(g^-) + O \left( \frac{1}{\sqrt K}\right) \tag{4.10.2}$$</p>
<p>其中, 第一个不等式: 根据 learning curve 经验确定, 而非理论(训练样本数少, 则误差大). 最后的小量 is unbiased error bar depend on $$g^-$$.</p>
<p>比较(4.10.1) 和 (4.10.2), 在验证集上的验证误差估计得到的 $$E_{out}$$ 有可能比用全部 数据集得到的 $$E_{in}$$ 估计的 $$E_{out}$$ 要好. 因为(4.10.1)中 假设集的 VC 维数可能很大.</p>
<p>现在, 我们知道, 用验证集来估计 $$E_{out}$$, 而该验证集不会影响学习过程. 这是验证集使用的一种方式, 其实, 我们还可以用验证集来影响学习过程. 下面道来.</p>
<hr />
<h2 id="2model-selection"><a name="user-content-2model-selection" href="#2model-selection" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>2.Model Selection</h2>
<p>Validtion 的重要作用是 Model Selection. 这意味着, 我们可以使用 Validation 对 模型进行选择: 从线性模型或非线性模型中进行选择; 也可以从一个模型的1阶, 2阶, &hellip;, 多阶多项式中进行选择; 或选择 regularization 中的 regularization parameter 参数.</p>
<p><img alt="05-model-selection" src="https://dn-learnml.qbox.me/image/ai/lfd_ch04_05_model_selection.JPG" /></p>
<p>假设我们有 M 个模型 $${\cal H_1, H_2, \cdots } {\cal H}_M$$, 在每一个模型上, 我们使用训练集训练, 验证集进行验证, 得到 validation errors $$E_1, \cdots, E_M$$, 参见下图.</p>
<p><img alt="06-m-models" src="https://dn-learnml.qbox.me/image/ai/lfd_ch04_06_M_hypothesis.JPG" /></p>
<p>$$E_{m} = E_{val}(g^{-}_m); \ \ m =1, 2, &hellip;, M.$$</p>
<p>每个验证误差估计对应的模型$${\cal H}<em out="out">m$$的$$E</em>(g^{-}_m)$$</p>
<p>我们如何确定最后的模型呢? 哪个 validation error 最小, 我们就选哪个模型. $$E_{m^{\ast}} \leq E_m, \ for \ m=1, &hellip;, M$$. 其所对应的 $$\cal H_{m^{\ast}}$$ 就是我们最后选择的模型. 这时候值得注意的是: $$E_{m^{\ast}}$$ 不再是 $$E_{out}(g^{-}_{m^{\ast}})$$ 的无偏估计.(思考下为什么? 因为我们选择验证误差最小的那个模型来估计, 所以不再是无偏估计.)</p>
<p>书中以 $$\cal H_2, H_5$$ 之间的模型选择为例. target function 的复杂度 $$Q_f = 3$$, 噪声水平 $$\sigma^2 = 0.4$$, 数据集样本数目 $$N = 35$$. 最终假设的期望误差曲线如下图所示.</p>
<p><img alt="7-model-selection-example" src="https://dn-learnml.qbox.me/image/ai/lfd_ch04_07_model_selectin_example.JPG" /></p>
<p>以之前所学来理解 Model Selection 过程: 模型结果训练后的到最终假设, 这时候, 有 M 个最终假设.</p>
<p>$${\cal H}<em 2="2">{val} = { g_1^{-}, g</em>^{-}, \cdots, g_{M}^{-}}$$</p>
<p>这时候, Validation 假设集有 M 个假设. 下面的过程, 类似之前学习的过程, 在 M 个假设集中再确定一个最终假设$$g^{-}_{m^{\ast}}$$. 根据霍夫丁不等式和 VC边界, 我们可以得到式子(4.11)</p>
<p>$$E_{out}(g^{-}<em val="val">{m^{\ast}}) \leq E</em>(g^{-}_{m^{\ast}}) + O \left( \sqrt{\frac{\ln M}{K}} \right)$$</p>
<p>如果不用 validation set 来确定最终假设, 我们也可以在所有数据集N上进行训练, 然后比较 in-sample-error 来确定最终假设 $$g_m$$.</p>
<p>如果使用 validation set, 那么我们就比较 validation error 来确定最终假设  $$g_{m^{\ast}}^{-}$$. 用这种方法来进行模型选择, 前提是我们相信式(4.12) 第一个不等式的成立. (虽然我们不能证明其成立, 只是根据实际经验确定(参见 learning curve)). 在利用 validation set 选择模型后, 得到模型 $${\cal H_{m^{\ast}}}, E_{m^{\ast}}$$, 利用该假设集 $$\cal H_{m^{\ast}}$$, 再在所有数据集 D 上得到的最终假设 $$g_{m^{\ast}}$$.</p>
<p>$$E_{out}(g_{m^{\ast}}) \leq E_{out}(g_{m^{\ast}}^{-}) \leq E_{val}(g_{m^{\ast}}^{-}) + O \left( \sqrt{\frac{\ln M}{K}} \right) \tag{4.12}$$</p>
<p><img alt="08-validation_model_selection_error_comparing" src="https://dn-learnml.qbox.me/image/ai/lfd_ch04_08_validation_model_selection_error_comparing.JPG" /></p>
<p><img alt="09-" src="https://dn-learnml.qbox.me/image/ai/lfd_ch04_09_validation_example.JPG" /></p>
<p>两个假设集进行模型选择, 一个是5阶多项式的假设集, 一个是 10阶多项式的假设集. 该图来自台大机器学习基石[3]的L15课, 与书中所说的假设集不一样, 但是图形是一样的. [我都不晓得为什么模型不一样, 得到结果一样. 可能存在bug]. 结合式子(4.12) 来理解该曲线图. 并思考上面图中最后提出的问题. [问题解答: 因为 K 增加, 用于训练集的 N-K 数目就减小, 训练得到的最终假设 $$g_m^-$$ 效果比 使用所有 N个样本训练得到的 $$g_m$$ 要差, 这就会造成 红色曲线会出现部分高于黑色直线.]</p>
<p>Validation 方法需要在数据集中取出 K个样本作为 Validation Set, 从而减少训练样本数目, 这是 Validation 的缺点. (如果数据集本来就很少, 怎么办???)</p>
<p>文中接下来就介绍 Cross Validation.</p>
<hr />
<h2 id="3cross-validation"><a name="user-content-3cross-validation" href="#3cross-validation" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>3.Cross Validation</h2>
<blockquote>
<p>交叉验证.</p>
</blockquote>
<p><img alt="10-K-dilemma" src="https://dn-learnml.qbox.me/image/ai/lfd_ch04_10_dilemma.JPG" /></p>
<p>第一个近似, 建立在 K 值较小的基础之上, 因为 K 越小, N-K 越大, 训练得到的最终假设 $$g^{-}$$ 则越好, 这样 $$E_{out}(g^{-})$$(validation 得到的最终假设 的 out-of-sample error) 与 $$E_{out}(g)$$(在所有数据集N 上训练得到的最终假设的 out-of-sample error) 之间的差距就越越小.</p>
<p>但是, K 小, 比如 K = 1时, 根据式子(4.9), 则 $$E_{val}(g^{-})$$ 估计 $$E_{out}(g^{-})$$ 的 可靠度就变低. (最后的小量变大啦.)</p>
<p>$$E_{out}(g^-) \leq E_{val}(g^-) + O\left(\frac{1}{\sqrt{K}} \right) \tag{4.9}$$</p>
<p>这时候, 我们可以使用 cross validation 来估计 out-of-sample error. 书中介绍两种 cross validation 方法:</p>
<ul>
<li>Leave-One-Out</li>
<li>V-Fold (K-Fold)</li>
</ul>
<h3 id="31-leave-one-out"><a name="user-content-31-leave-one-out" href="#31-leave-one-out" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>3.1 Leave-One-Out</h3>
<p><img alt="11-loocv" src="https://dn-learnml.qbox.me/image/ai/lfd_ch04_11_loocv.JPG" /></p>
<p>留一法: 此时 validation set 的 K = 1, 即只有一个样本作为验证集, 其他的作为训练集. 每个样本要做过一次验证集, 总共会有 N 次不重复的 validation.</p>
<p>每一次 validtion 得到的 error 为:</p>
<p>$$e_n = E_{val}(g^{-}_n) = err \left( g^{-}_n(x_n), y_n \right)$$</p>
<p>$$E_{cv} = \frac{1}{N} \sum_{n=1}^{N} e_n = \frac{1}{N} \sum_{n=1}^{N} err \left( g^{-}_n(x_n), y_n \right)$$</p>
<p>案例[3]:</p>
<p><img alt="12-loocv-example" src="https://dn-learnml.qbox.me/image/ai/lfd_ch04_12_loocv_example.JPG" /></p>
<p>$$E_{cv}$$ 是 $$E_{out}(g^{-})$$ 的无偏估计. 这里 $$g^{-}$$ 在每一次 validation 时都不一样, 不再是单一假设的 $$g^{-}$$, 而是 $$g^{-}_n$$.</p>
<p><img alt="13-theory-guarantee" src="https://dn-learnml.qbox.me/image/ai/lfd_ch04_13_loocv_theory.JPG" /></p>
<blockquote>
<p>Theorem. $$E_{cv}$$ is an unbiased estimate of $$\bar E_{out}(N-1)$$(the expecteation of the model performance, $$\Bbb E [E_{out}(g)]$$, over data sets of size N-1)</p>
</blockquote>
<p><img alt="14-loocv-progress" src="https://dn-learnml.qbox.me/image/ai/lfd_ch04_14_loocv_progress.JPG" /></p>
<blockquote>
<p>How reliable is the cross validation estimate $$E_{cv}$$?</p>
</blockquote>
<p>只有计算 $$E_{cv}$$ 的方差 variance. 这时候 方差计算时, $$e_1, e_2, &hellip;, e_N$$ 不是相互独立的变量啦. (为什么, 自己思考下.)</p>
<p>实际中, 不是经常使用 Leave-One-Out 方法, 更多的是使用 V-Fold validation 方法.</p>
<h3 id="32-v-fold-k-fold"><a name="user-content-32-v-fold-k-fold" href="#32-v-fold-k-fold" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>3.2 V-Fold (K-Fold)</h3>
<blockquote>
<p>V-折交叉验证法 或 K-折交叉验证法.</p>
</blockquote>
<p><img alt="15-10-fold" src="https://dn-learnml.qbox.me/image/ai/lfd_ch04_15_k_fold_validation.JPG" /></p>
<p>该交叉验证法最常用的是 10折交叉验证. V-折交叉验证法 就是将数据集D 均匀分成V份, 总进行 V次 validation, 每一次选择不同的验证集, 其他的作为训练集. 比如上面的 10折交叉验证: 数据集均匀分成 10个子集, 第一次将 $$D_1$$ 作为验证集, 其他 9 个子集作为训练集, 然后得到最终假设 $$g^{-}_1$$, 第 v 次是, 将 $$D_v$$ 作为验证集, 其他 9 个子集作为训练集  然后得到最终假设 $$g^{-}_v$$, 依次下去, 10个子集都做过一次验证集后结束. 总共会进行10次 validation.</p>
<p>$$E_{cv}({\cal H, A}) = \frac{1}{V} \sum_{v=1}^{V} E_{val}^{(v)}(g_v^{-})$$</p>
<p>选择模型 by $$E_{cv}$$:</p>
<p>$$m^{\ast}: = {\bf argmin}<em cv="cv">{1\leq m \leq M} \left( E_m = E</em>({\cal H_m, A_m}) \right)$$</p>
<p>经验: 尝试 5折与10折.</p>
<hr />
<h2 id="sum"><a name="user-content-sum" href="#sum" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>Sum</h2>
<p>书中4.3节主要讲解 validation 的基础理论. 主要内容为:</p>
<ul>
<li>什么是 validation, validation set;</li>
<li>validation 进行模型选择;</li>
<li>介绍两种 cross validation:</li>
<li>Leave-One-Out validation</li>
<li>V-Fold cross validation</li>
</ul>
<p>书中第四章到此就结束. 第四章主要讲述内容总结[1]:</p>
<ul>
<li>Noise (stochasitic or deterministric) affects learning adversely, leading to overfitting</li>
<li>Regularization helps to prevent overfitting by constraining the model, reducing the impact of the noise, while still giving us flexibility to fit the data.</li>
<li>Validation and cross validation are useful techniques for estimating E_{out}. One important use of validation is model selection, in particular to estimate the amount of regularization to use.</li>
</ul>
<hr />
<h2 id="_1"><a name="user-content-_1" href="#_1" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>参考</h2>
<ol>
<li><a href="http://www.amlbook.com/support.html#_echapters">Learning From Data - A Short Course</a> Chapter 1 &amp; Chapter 3 The Linear Model</li>
<li><a href="http://www.cs.rpi.edu/~magdon/courses/LFD-Slides/SlidesLect13.pdf">Learning From Data: Lecture-Slides L13</a></li>
<li><a href="http://www.csie.ntu.edu.tw/~htlin/mooc/doc/15_handout.pdf">台大机器学习基石-L15_handout.pdf</a></li>
</ol>
<hr />
<h2 id="changelog"><a name="user-content-changelog" href="#changelog" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>ChangeLog</h2>
<pre><code>@Anifacc  
read:  4: 53
note:  4: 33
all:   9: 26
2017-09-27 beta 1.0 WX
</code></pre></article></body></html>